id: file:///ines-core.yaml
name: ines-core
prefixes:
  linkml: https://w3id.org/linkml/
  # qudt: http://qudt.org/schema/qudt/           # Core QUDT schema (classes like QuantityValue, Unit)
  unit: http://qudt.org/vocab/unit/            # Individual units (MegaW-HR, Meter, etc.)
  # qkind: http://qudt.org/vocab/quantitykind/   # Quantity kinds (Energy, Length, Mass, etc.)
imports:
  - linkml:types
default_range: string

classes:
  Entity:
    abstract: true
    description: abstract high-level class
    slots:
      - id
      - name
      - description

  Node:
    is_a: Entity
    abstract: true
    attributes:
      node_type:
        designates_type: true
        range: string
        description: balance, storage, commodity

  Balance:
    is_a: Node
    mixins:
      - HasFlow
      - HasPenalty

  Storage:
    is_a: Node
    mixins:
      - HasFlow
      - HasPenalty
      - HasInvestments
    slots:
      - storage_capacity
      - storages_existing
      - investment_cost

  Commodity:
    is_a: Node
    slots:
      - price_per_unit

  Unit:
    is_a: Entity
    mixins:
      - HasInvestments
    attributes:
      conversion_method:
        range: conversion_method_enum
        description: constant_efficiency
    slots:
      - efficiency
      - units_existing

  Flow:
    is_a: Entity
    abstract: true
    mixins:
      - HasProfiles
    slots:
      - source
      - sink
      - capacity
      - other_operational_cost
      - investment_cost
    unique_keys:
      source_sink:
        unique_key_slots:
          - source
          - sink

  Unit__to_node:
    is_a: Flow
    attributes:
      source:
        range: Unit
      sink:
        range: Node


  Node__to_unit:
    is_a: Flow
    attributes:
      source:
        range: Node
      sink:
        range: Unit

  Link:
    is_a: Entity
    mixins:
      - HasInvestments
    slot_usage:
      efficiency:
        any_of:
          - range: float
          - range: EfficiencyValue
    slots:
      - node_A
      - node_B
      - efficiency
      - capacity
      - links_existing
      - investment_cost
    attributes:
      transfer_method:
        range: transfer_method_enum
        description: regular_linear

  Solve_pattern:
    is_a: Entity
    attributes:
      solve_mode:
        range: solve_model_enum
        description: single_solve
      start_time:
        range: integer
      duration:
        range: linkml:duration
      time_resolution:

  System:
    is_a: Entity
    attributes:
      discount_rate:
        range: float
      timeline:
        multivalued: True


  HasFlow:
    mixin: true
    attributes:
      flow_annual:
        range: float
      flow_profile:
        range: float
        multivalued: True
      flow_scaling_method:
        range: flow_scaling_method_enum
        description: use_profile_directly, scale_to_annual

  HasPenalty:
    mixin: true
    attributes:
      penalty_upward:
        range: float
      penalty_downward:
        range: float

  HasInvestments:
    mixin: true
    attributes:
      investment_method:
        range: investment_method_enum
        description: not_allowed, no_limits
      interest_rate:
        range: float
      lifetime:
        range: float

  HasProfiles:
    mixin: true
    attributes:
      profile_method:
        range: profile_method_enum
        description: upper_limit, lower_limit
      profile_limit_upper:
        range: float
        multivalued: True
      profile_limit_lower:
        range: float
        multivalued: True

  DirectionalValue:
    slots:
      - forward
      - reverse

  EfficiencyValue:
    union_of:
      - float
      - DirectionalValue

  Database:
    tree_root: true
    attributes:
      balances:
        range: Balance
        multivalued: True
        inlined_as_list: True
        required: False
      storages:
        range: Storage
        multivalued: True
        inlined_as_list: True
        required: False
      commodity:
        range: Commodity
        multivalued: True
        inlined_as_list: True
        required: False
      unit:
        range: Unit
        multivalued: True
        inlined_as_list: True
        required: False
      node__to_unit:
        range: Node__to_unit
        multivalued: True
        inlined_as_list: True
        required: False
      unit__to_node:
        range: Unit__to_node
        multivalued: True
        inlined_as_list: True
        required: False
      link:
        range: Link
        multivalued: True
        inlined_as_list: True
        required: False
      solve_pattern:
        range: Solve_pattern
        multivalued: True
        inlined_as_list: True
        required: False
      system:
        range: System
        multivalued: True
        inlined_as_list: True
        required: False
    # slots:
      # - currency_year
      # - entity


slots:
  entity:
    range: Entity
    multivalued: true
    description: "All entities in this database"
  currency_year:
    pattern: "^cur:[A-Z]{3}_\\d{4}$"  # e.g., "cur:USD_2023"
    description: "QUDT currency and reference year for all monetary values in the dataset"
    comments:
      - "Currency codes must exist in http://qudt.org/vocab/currency/"
      - "Validation requires external QUDT vocabulary check"
      - "Maybe LinkML could validate against external vocabulary, but perhaps not well supported yet."
  id:
    identifier: true
    range: integer
    description: "Unique identifier of the entity"
  name:
    description: "Name of the entity"
  description:
    description: "Description of the entity"
  efficiency:
    range: float
    annotations:
      qudt_unit: "unit:PERCENT"
  capacity:
    range: float
    annotations:
      qudt_unit: "unit:MegaW"
  storage_capacity:
    range: float
    annotations:
      qudt_unit: "unit:MegaW-HR"
  storages_existing:
    range: float
    annotations:
      qudt_unit: "unit:UNITLESS"
  investment_cost:
    range: float
    description: "Price (in currency_year denomination) per kW"
  price_per_unit:
    range: float
    description: "Price (in currency_year denomination) per unit of the product being bought or sold"
  units_existing:
    range: float
    annotations:
      qudt_unit: "unit:UNITLESS"
  other_operational_cost:
    range: float
    description: "Cost (in currency_year denomination) per unit of the product flowing through"
  source:
    any_of:
      - range: Unit
      - range: Node
    description: "Source of the unidirectional flow"
  sink:
    any_of:
      - range: Unit
      - range: Node
    description: "Sink of the unidirectional flow"
  node_A:
    range: Node
    description: "First node of a bidirectional link"
  node_B:
    range: Node
    description: "Second node of a bidirectional link"
  links_existing:
    range: float
    annotations:
      qudt_unit: "unit:UNITLESS"
  forward:
    range: float
    required: true
  reverse:
    range: float
    required: true



enums:
  flow_scaling_method_enum:
    permissible_values:
      use_profile_directly:
        text: use_profile_directly
      scale_to_annual:
        text: scale_to_annual

  conversion_method_enum:
    permissible_values:
      constant_efficiency:
        text: constant_efficiency

  transfer_method_enum:
    permissible_values:
      regular_linear:
        text: regular_linear

  profile_method_enum:
    permissible_values:
      upper_limit:
        text: upper_limit
      lower_limit:
        text: lower_limit

  solve_model_enum:
    permissible_values:
      single_solve:
        text: single_solve

  investment_method_enum:
    permissible_values:
      not_allowed:
        text: not_allowed
      no_limits:
        text: no_limits
